114
2026年数据结构考研复习指导
某趟发生失配时，若已匹配相等的序列中没有相等的前后缀，则对应的部分匹配值为0，此
时滑动的位数最大，直接将模式串首字符向右滑动到主串当前位置进行下一趟比较；若已匹配相
等的序列中存在最大相等前后缀（可理解为首尾重合），则将模式串向右滑动到和主中中该相等
后缀对齐（这些重合的字符下一趟显然无需再比较），然后从主串当前位置进行下一趟比较。两
还有一种特例，在上述举例中并未出现，当某趟第一个字符比较就失配时，应如何处理呢？
此时，应让模式串向右滑动一位，再从主串当前位置的下一位开始比较。
2.next数组的手算方法
在实际的匹配过程中，模式串在内存中是不会滑动的，发生变化的是指针，前面的举例只
是手动模拟KMP算法的过程，也是为了让读者更为形象地进行理解。
命题追踪KMP算法中指针变化、比较次数的分析（2015、2019）
每趟匹配失败时，只有模式串指针i在变化，主串指针j不会回溯，为此可以定义一个next
数组，next[j］的含义是当模式中的第j个字符失配时，跳到next[j]位置继续比较。
下面给出一种求next数组的手算方法，仍以模式中'abcac'为例。
位置与主串当前位置的下一位置进行比较（注意，图中的下标为模式中编号）。
匹配失败，说明此元素不是a
主串
回
回
模式串
a1
b2
C3
a4
C5
第2个字符失配时，令next[2]=1，模式串的下次比较位置为1，相当于向右滑动1位。
注，模式串的next[1]=0、next[2]=1都是固定不变的。
匹配失败，说明此元素不是b
主串
回
回
?
?
a
模式串
a1
b2
C3
a4
C5
右滑
a1
b2
C3
a4
C5
在后面的手算过程中，在不匹配的位置前画一条分界线，模式串一步一步往后退，直到分
界线之前能对上（首尾重合），或模式串完全跨过分界线为止。
第3个字符失配时，模式串的下次比较位置为1，即next[3]=1，相当于向右滑动2位。
匹配失败，说明此元素不是c
主串
b
回
模式串
ai
b2
C3
a4
C5
右滑
a1
b2
C3
a4
C5
第4个字符失配时，模式串的下次比较位置为1，即next[4]=1，相当于向右滑动3位。
匹配失败，说明此元素不是a
主串
回
b
模式串
b2
C3
a4
C5
右滑
a1
C3
a4
