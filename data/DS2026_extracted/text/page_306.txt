294
2026年数据结构考研复习指导
*3.红黑树的删除
注意
本节难度较大，考查概率较低，读者可根据自身情况决定是否学习或学习的时机。
红黑树的插入操作容易导致连续的两个红结点，破坏性质④。而删除操作容易造成子树黑高
的变化（删除黑结点会导致根结点到叶结点间的黑结点数量减少），破坏性质。
删除过程也是先执行二叉查找树的删除方法。若待删结点有两个孩子，不能直接删除，而要找
到该结点的中序后继（或前驱）填补，即右子树中最小的结点，然后转换为删除该后继结点。由于后
继结点至多只有一个孩子，这样就转换为待删结点是终端结点或仅有一个孩子的情况。
最终，删除一个结点有以下两种情况：
·待删结点只有右子树或左子树。
·待删结点没有孩子。
1）若待删结点只有右子树或左子树，则只有两种情况，如图7.22所示。
删除Y
删除Y
或
黑结点
YR
红结点
图7.22只有右子树或左子树的删除情况
只有这两种情况存在。子树只有一个结点，且必然是红色，否则会破坏性质5。
2）待删结点无孩子，且该结点是红色的，这时可直接删除，而不需要做任何调整。
3）待删结点无孩子，且该结点是黑色的，这时设待删结点为y，x是用来替换y的结点（注
意，当y是终端结点时，x是黑色的NULL结点）。删除y后将导致先前包含y的任何路
径上的黑结点数量减1，因此y的任何祖先都不再满足性质，简单的修正办法就是将替
换y的结点x视为还有额外一重黑色，定义为双黑结点。也就是说，若将任何包含结点x
的路径上的黑结点数量加1，则在此假设下，性质5得到满足，但破坏了性质①。于
是，删除操作的任务就转化为将双黑结点恢复为普通结点。
分为以下四种情况，区别在于x的兄弟结点w及w的孩子结点的颜色不同。
情况1：x的兄弟结点w是红色的。
情况1，w必须有黑色左右孩子和父结点。交换w和父结点x.p的颜色，然后对x.p做一次左
旋，而不会破坏红黑树的任何规则。现在，x的新兄弟结点是旋转之前w的某个孩子结点，其颜
色为黑色，这样，就将情况1转换为情况2、3或4处理。调整方式如图7.23所示。
黑结点
情况1
红结点
图7.23情况1的调整方式
情况2：x的兄弟结点w是黑色的，且w的右孩子是红色的。
情况3：x的兄弟结点w是黑色的，w的左孩子是红色的，w的右孩子是黑色的。
情况2（RR，左单旋），即这个红结点是其爷结点的右孩子的右孩子。交换w和父结点x.p
