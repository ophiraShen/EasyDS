第8章排
序
359
最新408统考大纲增加了考点“堆的应用”，堆的应用只有两个：堆排序和优先队列（见本
节综合题7），优先队列也利用了堆排序的思想，因此本节仅介绍堆排序。
堆排序的思路很简单：首先将存放在L[1..n]中的n个元素建成初始堆，因为堆本身的特点
（以大顶堆为例），所以堆顶元素就是最大值。输出堆顶元素后，通常将堆底元素送入堆顶，此时
根结点已不满足大顶堆的性质，堆被破坏，将堆顶元素向下调整使其继续保持大顶堆的性质，再
输出堆顶元素。如此重复，直到堆中仅剩一个元素为止。可见，堆排序需要解决两个问题：①如
何将无序序列构造成初始堆？②输出堆顶元素后，如何将剩余元素调整成新的堆？
命题追踪初始建堆的操作（2018、2021）
堆排序的关键是构造初始堆。建堆思路是从后往前检查所有分支结点，看是否满足堆的要求，
若不满口，则对以该分支结点为根的子树进行调整。Ⅱ个结点的完全二叉树，最后一个结点是第
Ln/2」个结点的孩子。对以第Ln/2」个结点为根的子树筛选（对于大根堆，若根结点的关键字小于
左右孩子中关键字较大者，则交换），使该子树成为堆。之后向前依次对以各结点（Ln/2」-1～1）
为根的子树进行筛选，看该结点值是否大于其左右子结点的值，若不大于，则将左右子结点中的
较大值与之交换，交换后可能会破坏下一级的堆，于是继续采用上述方法构造下一级的堆，直到
以该结点为根的子树构成堆为止。反复利用上述调整堆的方法建堆，直到根结点。
如图8.6所示，初始时调整L（4)子树，09<32，交换，交换后满足堆的定义；向前继续调整
L(3)子树，78<左右孩子的较大者87，交换，交换后满足堆的定义；向前调整L(2)子树，17<左
右孩子的较大者45，交换后满足堆的定义；向前调整至根结点L（1），53<左右孩子的较大者87，
交换，交换后破坏了L(3)子树的堆，采用上述方法对L(3)进行调整，53<左右孩子的较大者78,
交换，至此该完全二叉树满足堆的定义。
）初始i
（b)i=
（c)i=2
09
(d)i=1
(e)结果
图8.6自下往上逐步调整为大根堆
命题追踪堆的删除操作及调整操作分析（2015、2024）
输出堆顶元素后，将堆的最后一个元素与堆顶元素交换，此时堆的性质被破坏，需要向下进
行筛选。将09和左右孩子的较大者78交换，交换后破坏了L(3)子树的堆，继续对L(3)子树向下
筛选，将09和左右孩子的较大者65交换，交换后得到了新堆，调整过程如图8.7所示。
