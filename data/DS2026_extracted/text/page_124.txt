112
2026年数据结构考研复习指导
算法思想是：从主串S的第一个字符起，与模式串T的第一个字符比较，若相等，则继续逐个比
较后续字符；否则从主串的下一个字符起，再重新和模式串T的字符比较；以此类推，直至模式
串T中的每个字符依次和主串S中的一个连续的字符序列相等，则称匹配成功，函数值为与模式
串T中第一个字符相等的字符在主串S中的序号，否则称匹配不成功，函数值为零。
图4.2展示了模式串T='abcac'和主串s的匹配过程。
1=3
第一趟匹配
ab
ap
ab
↑j=3
i=2
第二趟匹配
ab
i=7
第三趟匹配
abc
i=4
第四趟匹配ab
i=5
第五趟匹配aba
=
图4.2简单模式匹配算法举例
在简单模式匹配算法中，设主串和模式串的长度分别为n和m（n》m），则最多需要进行n-m+1
趟匹配，每趟最多需要进行m次比较，最坏时间复杂度为O（nm）。例如，当模式串为+0000001+而
主中为：0000000000000000000000000000000000000000000001·时，由于模式串中的前6
个字符均为＇0＇，主串中的前45个字符均为+0＇，每趟匹配都是比较到模式串中的最后一个字符时才
发现不等，整个匹配过程中指针i需要回溯39次，总比较次数为40x7=280次。
4.2.2串的模式匹配算法一一KMP算法
在图4.2的第三趟匹配过程中，i=7、j=5 的字符比较，结果不等，于是又从i=4、j=1重新
开始比较。然而，仔细观察会发现，i=4和j=1、i=5和j=1以及i=6和j=1这三次比较都是不
必进行的。从第三趟部分匹配的结果可知，主串的第4个、第5介、第6个字符是'b'、'c'、'a"
（模式串的第2、第3、第4个字符），因为模式串的第1个字符是+a＇，所以再和这三个字符进行比
较纯属多余，而只需将模式串向右滑动三个字符的位置，再进行i=7、j=2的比较即可。
在简单模式匹配算法中，每趟匹配失败都是模式串向右滑动一位后从头开始比较的。而某趟
已匹配相等的字符序列是模式串的某个前缀，因此可从分析模式串本身的结构着手，若已匹配相
等的前缀序列中有某个后缀正好是模式串的前缀，则可将模式中向右滑动到与这些相等字符对齐
