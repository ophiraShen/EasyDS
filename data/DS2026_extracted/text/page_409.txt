第8章排
397
04.【解答】
设初始归并段个数n=12，外归并路数k=4，计算（n-1)%（k-1）=11%3=2≠0，说明不能做
完全的4路归并，因为多出了两个初始归并段，必须添加k-2-1=1个长度为0的空归并段，才
能构成严格的4路归并树，即每次归并都有k个归并段参加归并。
此时，归并树的内结点应有(n-1+1)/(k-1)=12/3=4个，如下图所示。
030898234028
(a)
(b)
(c)
(p）
WPL=（3+6+8)×3+(9+18+20+30+44+60+62)×2+（68+85）×1=51+486+153=690。
05.【解答】
1）当文件中的n个记录升序排列时，只生成一个归并段，长度达到最大，为n。若初始工作
区内的m个元素都大于输入文件中剩下的所有记录，则第一个归并段的长度就为m，此时为第-
个归并段长度最小的情况。排序过程如下表所示。
输出文件FO
工作区WA
输入文件FI
一
51,94,37,92,14,63,15,99,48,56,23,60,31,17,43,8,90,166,100
一
51,94,37,92
14,63,15,99,48,56,23,60,31,17,43,8,90,166,100
37
51,94,14,92
63,15,99,48,56,23,60,31,17,43,8,90,166,100
37, 51
94,14,92,63
15,99,48,56,23,60,31,17,43,8,90,166,100
37,51,63
15,94,14,92
99,48,56,23,60,31,17,43,8,90,166,100
37,51,63,92
15,94,14,99
48,56,23,60,31,17,43,8,90,166,100
37, 51, 63, 92, 94
15, 14, 99,48
56,23,60,31,17,43,8,90,166,100
37,51, 63, 92,94,99
15, 14, 56,48
23,60,31,17,43,8,90,166,100
37,51,63,92,94,99#
15,14,56,48
23,60,31,17,43,8,90,166,100
14
15,23,56,48
60,31,17,43,8,90,166,100
14,15
60,23,56,48
31,17,43,8,90,166,100
14,15,23
60,31,56,48
17,43,8,90,166,100
14,15,23,31
60,17,56,48
43,8, 90,166,100
14,15,23,31,48
60, 17, 56, 43
8,90,166,100
14,15,23,31,48,56
60,17,8,43
90,166,100
14,15,23,31,48,56,60
90,17,8,43
166,100
14,15,23,31,48,56,60,90
166, 17, 8,43
100
14,15,23,31,48,56,60,90,166
100, 17, 8,43
14,15,23,31,48,56,60,90,166#
100,17,8,43
8
100,17,43
8,17
100,43
8,17,43
100
8,17,43,100
8,17,43,100#
