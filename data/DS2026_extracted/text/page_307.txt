第7章查
找
295
的颜色，把w的右孩子着为黑色，并对x的父结点x.p做一次左旋，将x变为单重黑色，此时不
再破坏红黑树的任何性质，结束。调整方式如图7.24所示。
情况2
黑结点红结点
图7.24情况2的调整方式
情况3（RL，先右旋，再左旋），即这个红结点是其爷结点的右孩子的左孩子。交换w和其
左孩子的颜色，然后对w做一次右旋，而不破坏红黑树的任何性质。现在，x的新兄弟结点v的
右孩子是红色的，这样就将情况3转换为了情况2。调整方式如图7.25所示。
情况3
新结点
注：白色结点表示既可为黑色也可为红色，对操作没有影响
黑结点
红结点
图7.25情况3的调整方式
情况4：x的兄弟结点w是黑色的，且w的两个孩子结点都是黑色的。
在情况4中，因为w也是黑色的，所以可从x和w上去掉一重黑色，使得x只有一重黑色而
w变为红色。为了补偿从x和w中去掉的一重黑色，把x的父结点x.p额外着一层黑色，以保持
局部的黑高不变。通过将x.p作为新结点x来循环，x上升一层。若是通过情况1进入情况4的，
因为原来的x.p是红色的，将新结点x变为黑色，终止循环，结束。调整方式如图7.26所示。
新结点x
情况4
黑结点红结点
图7.26情况4的调整方式
若x是父结点x.p的右孩子，则还有四种对称的情况，处理方式类似，不再赘述。
归纳总结：在情况4中，因x的兄弟结点w及左右孩子都是黑色，可以从x和w中各提取
重黑色（以让x变为普通黑结点），不会破坏性质④，并把调整任务向上“推”给它们的父结点
x.p。在情况1、2和3中，因为x的兄弟结点w或w左右孩子中有红结点，所以只能在x.p子树
内用调整和重新着色的方式，且不能改变x原根结点的颜色（否则向上可能破坏性质④）。情况1
虽然可能会转换为情况4，但因为新x的父结点x.p是红色的，所以执行一次情况4就会结束。情
况1、2和3在各执行常数次的颜色改变和至多3次旋转后便终止，情况4是可能重复执行的唯
